# Class-based Cocotb Testbench for ALSU

This repository provides a class-based Cocotb testbench for verifying an Arithmetic Logic and Shift Unit (ALSU). The testbench is designed to generate stimulus, drive the DUT (Device Under Test), monitor outputs, and verify the results using a scoreboard. The testbench utilizes a modular approach, breaking down the functionality into several classes like sequencer, driver, monitor, and scoreboard.

## Directory Structure

```
├───RTL
│   ├── ALSU.sv
│   ├── ALSU_ref.sv
│   └── ALSU_top.sv
│
└───Testbench
    ├── ALSU_test.py
    ├── cocotb_utils.py
    ├── driver.py
    ├── item.py
    ├── Makefile
    ├── monitor.py
    ├── reset_utils.py
    ├── run.sh
    ├── scoreboard.py
    ├── sequence.py
    ├── sequencer.py
    └── setup.tcl
```

## Overview

This repository contains a modular testbench for an ALSU design, structured as follows:

- **RTL**: Contains the ALSU Verilog files including the top-level module and reference model.
- **Testbench**: Contains the Python files implementing the testbench, such as the sequencer, driver, and scoreboard, along with a Makefile for simulation setup and `setup.tcl` for waveform configuration.

### Key Components:
- **ALSU_test.py**: The top-level testbench script that initializes and runs the test, creating clock, reset, and verification components.
- **driver.py**: Drives stimulus to the DUT based on items generated by the sequencer.
- **monitor.py**: Monitors outputs from the DUT and compares them against the expected values.
- **scoreboard.py**: Verifies if the monitored outputs match the expected results and tracks pass/fail counts.
- **item.py**: Defines the data structure for stimulus items sent to the DUT.
- **sequencer.py**: Controls the flow of stimulus items and sends them to the driver.
- **cocotb_utils.py**: Utility functions for testbench operations, such as calculating maximum values for signal ranges.

## Setup

### Prerequisites
- **Python** (3.6+)
- **Cocotb**: [Installation Instructions](https://cocotb.readthedocs.io/en/stable/install.html)
- **Simulation Tool**: Questa, ModelSim, or other supported simulators
- **Make**: For building the simulation

### Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/amrelbatarny/Class_based_Cocotb_Testbench_for_an_ALSU
   cd Class_based_Cocotb_Testbench_for_an_ALSU
   ```

2. Install dependencies:
   ```bash
   pip install cocotb
   ```

3. Install your simulator (e.g., Questa or ModelSim).

## Running the Test

1. run this script to clean previous simulation files then run the simulation:
   ```bash
   bash run.sh
   ```

2. The test results will be displayed in the simulation log, with pass/fail counts logged by the scoreboard.

## Makefile

The provided Makefile is configured to run the simulation with Cocotb. It automatically includes the Verilog sources and sets the top-level module for the simulation. To modify the simulation tool or other settings, you can adjust the variables in the Makefile.

```Makefile
# Example Makefile variables
SIM = questa
TOPLEVEL = ALSU_top
MODULE = ALSU_test
```

## Tcl Script

The `setup.tcl` file is used to configure the waveform output for the simulation, allowing you to visualize important signals during the simulation. You can modify this file to add or remove signals from the waveform viewer.

## Files in the Testbench Directory

- **ALSU_test.py**: The test function that runs the testbench.
- **cocotb_utils.py**: Utility functions like `max()` to handle signal widths.
- **driver.py**: Class to drive the stimulus to the DUT.
- **item.py**: Class defining the structure of each stimulus item.
- **Makefile**: For building and running the simulation.
- **monitor.py**: Class to monitor the DUT outputs and put them in the queue.
- **reset_utils.py**: Function to reset the DUT.
- **run.sh**: Shell script to clean and run the simulation.
- **scoreboard.py**: Class that checks the DUT outputs against the expected values.
- **sequence.py**: Class that handles the stimulus generation sequence.
- **sequencer.py**: Class that queues the stimulus items for the driver.
- **setup.tcl**: Tcl script to set up the waveform viewer.

## Contribution

We welcome contributions to this educational project. Feel free to submit pull requests for improvements or additional features.

## Contact

Click on the image below

<a href="https://beacons.ai/amrelbatarny" target="_blank">
  <img align="left" alt="Beacons" width="180px" src="https://www.colormango.com/development/boxshot/beacons-ai_154511.png" />
</a> 
<br>
